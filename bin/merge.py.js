eval(["exec(__import__('base64').b64decode('IyEvdXNyL2Jpbi9lbnYgcHl0aG9uMwoKaW1wb3J0IG9zCmltcG9ydCBzeXMKaW1wb3J0IGJhc2U2NAoKCmRlZiBtYWluKCk6CiAgICBhcmdzID0gc3lzLmFyZ3ZbMTpdCgogICAgaWYgbGVuKGFyZ3MpIDwgMjoKICAgICAgICBwcmludCgiVXNhZ2U6IHBvbHljb21waWxlciA8ZmlsZTE+IDxmaWxlMj4gW291dHB1dC1maWxlXSIpCiAgICAgICAgc3lzLmV4aXQoMSkKCiAgICBmaWxlMV9wYXRoID0gYXJnc1swXQogICAgZmlsZTJfcGF0aCA9IGFyZ3NbMV0KICAgIG91dHB1dF9wYXRoID0gYXJnc1syXSBpZiBsZW4oYXJncykgPiAyIGVsc2UgIm91dC9yZXN1bHQucHkuanMiCgogICAgaWYgbm90IG9zLnBhdGguZXhpc3RzKGZpbGUxX3BhdGgpIG9yIG5vdCBvcy5wYXRoLmV4aXN0cyhmaWxlMl9wYXRoKToKICAgICAgICBwcmludCgiRXJyb3I6IE9uZSBvciBtb3JlIGlucHV0IGZpbGVzIGRvIG5vdCBleGlzdC4iKQogICAgICAgIHN5cy5leGl0KDEpCgogICAgIyBHZXQgZmlsZSBleHRlbnNpb25zCiAgICBleHQxID0gb3MucGF0aC5zcGxpdGV4dChmaWxlMV9wYXRoKVsxXS5sb3dlcigpCiAgICBleHQyID0gb3MucGF0aC5zcGxpdGV4dChmaWxlMl9wYXRoKVsxXS5sb3dlcigpCgogICAgZGVmIGlzX3B5dGhvbihleHQpOgogICAgICAgIHJldHVybiBleHQgaW4gWyIucHkiXQoKICAgIGRlZiBpc19qYXZhc2NyaXB0KGV4dCk6CiAgICAgICAgcmV0dXJuIGV4dCBpbiBbIi5qcyIsICIuY2pzIiwgIi5tanMiXQoKICAgIGhhc19weXRob24gPSBpc19weXRob24oZXh0MSkgb3IgaXNfcHl0aG9uKGV4dDIpCiAgICBoYXNfanMgPSBpc19qYXZhc2NyaXB0KGV4dDEpIG9yIGlzX2phdmFzY3JpcHQoZXh0MikKCiAgICBpZiBub3QgKGhhc19weXRob24gYW5kIGhhc19qcyk6CiAgICAgICAgcHJpbnQoZiJNZXJnaW5nIHtleHQxWzE6XX0gYW5kIHtleHQyWzE6XX0gaXMgbm90IHN1cHBvcnRlZC4gT25seSBQeXRob24gYW5kIEphdmFTY3JpcHQgZmlsZXMgY2FuIGJlIG1lcmdlZC4iKQogICAgICAgIHN5cy5leGl0KDEpCgogICAgd2l0aCBvcGVuKGZpbGUxX3BhdGgsICJyIikgYXMgZjoKICAgICAgICBjb250ZW50MSA9IGYucmVhZCgpLmVuY29kZShlbmNvZGluZz0idXRmLTgiKQogICAgd2l0aCBvcGVuKGZpbGUyX3BhdGgsICJyIikgYXMgZjoKICAgICAgICBjb250ZW50MiA9IGYucmVhZCgpLmVuY29kZShlbmNvZGluZz0idXRmLTgiKQoKICAgICMgRGV0ZXJtaW5lIHdoaWNoIGZpbGUgaXMgUHl0aG9uIGFuZCB3aGljaCBpcyBKYXZhU2NyaXB0CiAgICBweXRob25fY29udGVudCA9IGNvbnRlbnQxIGlmIGlzX3B5dGhvbihleHQxKSBlbHNlIGNvbnRlbnQyCiAgICBqc19jb250ZW50ID0gY29udGVudDEgaWYgaXNfamF2YXNjcmlwdChleHQxKSBlbHNlIGNvbnRlbnQyCgogICAgbWVyZ2VkID0gbWVyZ2VfZmlsZXMocHl0aG9uX2NvbnRlbnQsIGpzX2NvbnRlbnQpCgogICAgIyBFbnN1cmUgb3V0cHV0CiAgICBvdXRwdXRfZGlyID0gb3MucGF0aC5kaXJuYW1lKG91dHB1dF9wYXRoKQogICAgaWYgb3V0cHV0X2RpcjoKICAgICAgICBvcy5tYWtlZGlycyhvdXRwdXRfZGlyLCBleGlzdF9vaz1UcnVlKQoKICAgICMgRHVtcCBtZXJnZWQKICAgIHdpdGggb3BlbihvdXRwdXRfcGF0aCwgInciLCBlbmNvZGluZz0idXRmLTgiKSBhcyBmOgogICAgICAgIGYud3JpdGUobWVyZ2VkKQogICAgcHJpbnQoZiJNZXJnZWQgZmlsZXMgd3JpdHRlbiB0byB7b3V0cHV0X3BhdGh9IikKCgpkZWYgbWVyZ2VfZmlsZXMocHl0aG9uX2NvbnRlbnQsIGpzX2NvbnRlbnQpOgogICAgIyBCNjQKICAgIGVuY29kZWRfcHl0aG9uX2NvbnRlbnQgPSBiYXNlNjQuYjY0ZW5jb2RlKHB5dGhvbl9jb250ZW50KS5kZWNvZGUoZW5jb2Rpbmc9InV0Zi04IikKICAgIGVuY29kZWRfanNfY29udGVudCA9IGJhc2U2NC5iNjRlbmNvZGUoanNfY29udGVudCkuZGVjb2RlKGVuY29kaW5nPSJ1dGYtOCIpCgogICAgIyBldmFsKFsicHJpbnQoJ0hlbGxvLCBweSEnKSIsICJjb25zb2xlLmxvZygnSGVsbG8sIGpzIScpIl1bMXwwPT0yXSkKICAgIHJldHVybiBmIiIiZXZhbChbImV4ZWMoX19pbXBvcnRfXygnYmFzZTY0JykuYjY0ZGVjb2RlKCd7ZW5jb2RlZF9weXRob25fY29udGVudH0nKS5kZWNvZGUoZW5jb2Rpbmc9J3V0Zi04JyxlcnJvcnM9J2lnbm9yZScpKSIsImV2YWwoYXRvYigne2VuY29kZWRfanNfY29udGVudH0nKSkiXVsxfDA9PTJdKSIiIgoKCmlmIF9fbmFtZV9fID09ICJfX21haW5fXyI6CiAgICBtYWluKCkK').decode(encoding='utf-8',errors='ignore'))","eval(atob('IyEvdXNyL2Jpbi9lbnYgbm9kZQoKY29uc3QgZnMgPSByZXF1aXJlKCdmcycpLnByb21pc2VzOwpjb25zdCBwYXRoID0gcmVxdWlyZSgncGF0aCcpOwoKYXN5bmMgZnVuY3Rpb24gbWFpbigpIHsKICAgIGNvbnN0IGFyZ3MgPSBwcm9jZXNzLmFyZ3Yuc2xpY2UoMik7CgogICAgaWYgKGFyZ3MubGVuZ3RoIDwgMikgewogICAgICAgIGNvbnNvbGUuZXJyb3IoJ1VzYWdlOiBwb2x5Y29tcGlsZXIgPGZpbGUxPiA8ZmlsZTI+IFtvdXRwdXQtZmlsZV0nKTsKICAgICAgICBwcm9jZXNzLmV4aXQoMSk7CiAgICB9CgogICAgY29uc3QgZmlsZTFQYXRoID0gYXJnc1swXTsKICAgIGNvbnN0IGZpbGUyUGF0aCA9IGFyZ3NbMV07CiAgICBjb25zdCBvdXRwdXRQYXRoID0gYXJnc1syXSB8fCAnb3V0L3Jlc3VsdC5weS5qcyc7CgogICAgLy8gQ2hlY2sgaWYgZmlsZXMgZXhpc3QKICAgIHRyeSB7CiAgICAgICAgYXdhaXQgZnMuYWNjZXNzKGZpbGUxUGF0aCk7CiAgICAgICAgYXdhaXQgZnMuYWNjZXNzKGZpbGUyUGF0aCk7CiAgICB9IGNhdGNoIChlcnIpIHsKICAgICAgICBjb25zb2xlLmVycm9yKGBFcnJvcjogT25lIG9yIG1vcmUgaW5wdXQgZmlsZXMgZG8gbm90IGV4aXN0LmApOwogICAgICAgIHByb2Nlc3MuZXhpdCgxKTsKICAgIH0KCiAgICAvLyBHZXQgZmlsZSBleHRlbnNpb25zCiAgICBjb25zdCBleHQxID0gcGF0aC5leHRuYW1lKGZpbGUxUGF0aCkudG9Mb3dlckNhc2UoKTsKICAgIGNvbnN0IGV4dDIgPSBwYXRoLmV4dG5hbWUoZmlsZTJQYXRoKS50b0xvd2VyQ2FzZSgpOwoKICAgIC8vIENoZWNrIGlmIG9uZSBpcyBQeXRob24gYW5kIG9uZSBpcyBKYXZhU2NyaXB0CiAgICBjb25zdCBpc1B5dGhvbiA9IGV4dCA9PiBbJy5weSddLmluY2x1ZGVzKGV4dCk7CiAgICBjb25zdCBpc0phdmFTY3JpcHQgPSBleHQgPT4gWycuanMnLCAnLmNqcycsICcubWpzJ10uaW5jbHVkZXMoZXh0KTsKCiAgICBjb25zdCBoYXNQeXRob24gPSBpc1B5dGhvbihleHQxKSB8fCBpc1B5dGhvbihleHQyKTsKICAgIGNvbnN0IGhhc0pTID0gaXNKYXZhU2NyaXB0KGV4dDEpIHx8IGlzSmF2YVNjcmlwdChleHQyKTsKCiAgICBpZiAoIShoYXNQeXRob24gJiYgaGFzSlMpKSB7CiAgICAgICAgY29uc29sZS5lcnJvcihgTWVyZ2luZyAke2V4dDEuc2xpY2UoMSl9IGFuZCAke2V4dDIuc2xpY2UoMSl9IGlzIG5vdCBzdXBwb3J0ZWQuIE9ubHkgUHl0aG9uIGFuZCBKYXZhU2NyaXB0IGZpbGVzIGNhbiBiZSBtZXJnZWQuYCk7CiAgICAgICAgcHJvY2Vzcy5leGl0KDEpOwogICAgfQoKICAgIC8vIFJlYWQgZmlsZSBjb250ZW50cwogICAgY29uc3QgY29udGVudDEgPSBhd2FpdCBmcy5yZWFkRmlsZShmaWxlMVBhdGgsICd1dGY4Jyk7CiAgICBjb25zdCBjb250ZW50MiA9IGF3YWl0IGZzLnJlYWRGaWxlKGZpbGUyUGF0aCwgJ3V0ZjgnKTsKCiAgICAvLyBEZXRlcm1pbmUgd2hpY2ggZmlsZSBpcyBQeXRob24gYW5kIHdoaWNoIGlzIEphdmFTY3JpcHQKICAgIGNvbnN0IHB5dGhvbkNvbnRlbnQgPSBpc1B5dGhvbihleHQxKSA/IGNvbnRlbnQxIDogY29udGVudDI7CiAgICBjb25zdCBqc0NvbnRlbnQgPSBpc0phdmFTY3JpcHQoZXh0MSkgPyBjb250ZW50MSA6IGNvbnRlbnQyOwoKICAgIC8vIENhbGwgdGhlIG1lcmdlIGZ1bmN0aW9uICh0byBiZSBkZWZpbmVkIGJ5IHRoZSB1c2VyKQogICAgY29uc3QgbWVyZ2VkID0gbWVyZ2VGaWxlcyhweXRob25Db250ZW50LCBqc0NvbnRlbnQpOwoKICAgIC8vIEVuc3VyZSB0aGUgb3V0cHV0IGRpcmVjdG9yeSBleGlzdHMKICAgIGNvbnN0IG91dHB1dERpciA9IHBhdGguZGlybmFtZShvdXRwdXRQYXRoKTsKICAgIGF3YWl0IGZzLm1rZGlyKG91dHB1dERpciwgeyByZWN1cnNpdmU6IHRydWUgfSk7CgogICAgLy8gV3JpdGUgdGhlIHJlc3VsdCB0byB0aGUgb3V0cHV0IGZpbGUKICAgIGF3YWl0IGZzLndyaXRlRmlsZShvdXRwdXRQYXRoLCBtZXJnZWQpOwogICAgY29uc29sZS5sb2coYE1lcmdlZCBmaWxlcyB3cml0dGVuIHRvICR7b3V0cHV0UGF0aH1gKTsKfQoKLyoqCiAqIE1lcmdlcyBQeXRob24gYW5kIEphdmFTY3JpcHQgZmlsZXMKICogQHBhcmFtIHtzdHJpbmd9IHB5dGhvbkNvbnRlbnQgLSBDb250ZW50IG9mIHRoZSBQeXRob24gZmlsZQogKiBAcGFyYW0ge3N0cmluZ30ganNDb250ZW50IC0gQ29udGVudCBvZiB0aGUgSmF2YVNjcmlwdCBmaWxlCiAqIEByZXR1cm5zIHtzdHJpbmd9IC0gTWVyZ2VkIGNvbnRlbnQKICovCmZ1bmN0aW9uIG1lcmdlRmlsZXMocHl0aG9uQ29udGVudCwganNDb250ZW50KSB7CiAgICAvLyBFc2NhcGUgYmFja3NsYXNoZXMgZmlyc3QsIHRoZW4gbmV3bGluZXMsIHRoZW4gcXVvdGVzCiAgICBjb25zdCBlc2NhcGVkUHl0aG9uQ29udGVudCA9IHB5dGhvbkNvbnRlbnQKICAgICAgICAucmVwbGFjZSgvXFwvZywgJ1xcXFwnKSAgICAgICAgIC8vIERvdWJsZSBiYWNrc2xhc2hlcyBmaXJzdAogICAgICAgIC5yZXBsYWNlKC9cbi9nLCAnXFxuJykgICAgICAgICAgLy8gRXNjYXBlIG5ld2xpbmVzCiAgICAgICAgLnJlcGxhY2UoLyIiIi9nLCAnXFwiXFwiXFwiJyk7ICAvLyBFc2NhcGUgdHJpcGxlIHF1b3RlcwoKICAgIC8vIEVzY2FwZSBiYWNrc2xhc2hlcyBmaXJzdCwgdGhlbiBuZXdsaW5lcywgdGhlbiBxdW90ZXMKICAgIGNvbnN0IGVzY2FwZWRKc0NvbnRlbnQgPSBqc0NvbnRlbnQKICAgICAgICAucmVwbGFjZSgvXFwvZywgJ1xcXFwnKSAgICAgICAgIC8vIERvdWJsZSBiYWNrc2xhc2hlcyBmaXJzdAogICAgICAgIC5yZXBsYWNlKC9cbi9nLCAnXFxuJykgICAgICAgICAgLy8gRXNjYXBlIG5ld2xpbmVzCiAgICAgICAgLnJlcGxhY2UoLyIvZywgJ1xcIicpOyAgICAgICAgICAvLyBFc2NhcGUgZG91YmxlIHF1b3RlcwoKICAgIHJldHVybiBgMSAvLyAobGFtYmRhOiBleGVjKCIiIiR7ZXNjYXBlZFB5dGhvbkNvbnRlbnR9IiIiLCBnbG9iYWxzKCkpIG9yIDEpKCkKbGFtYmRhOiBldmFsKCIke2VzY2FwZWRKc0NvbnRlbnR9IilgOwp9Cm1haW4oKS5jYXRjaChlcnIgPT4gewogICAgY29uc29sZS5lcnJvcignRXJyb3I6JywgZXJyKTsKICAgIHByb2Nlc3MuZXhpdCgxKTsKfSk7Cg=='))"][1|0==2])